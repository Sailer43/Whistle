#:kivy 1.10.0
#:import window kivy.core.window

<LoginScreen>:
    canvas.before:
        Color:
            rgba: app.colors["back01"]
        Rectangle:
            pos: self.pos
            size: self.size
    login_username: login_username.__self__
    login_password: login_password.__self__

    BoxLayout:

        orientation: 'vertical'
        padding: [20, 20, 20, 20]
        spacing: 10

        BoxLayout:
            orientation: 'vertical'
            padding: [20, 0, 20, 0]

            BoxLayout:
                orientation: 'horizontal'
                padding: [0, 5, 0, 5]
                size_hint: (1, 0.5)

                Label:
                    text: 'Username:'
                    size_hint: (0.25, 1)

                TextInput:
                    id: login_username
                    text: ''
                    size_hint: (0.75, 1)
                    hint_text: 'enter your username here'
                    hint_text_color: [0.5, 0.5, 0.5, 1]
                    background_color: [1, 1, 1, 1]
                    cursor_color: [0, 0, 0, 1]
                    foreground_color: [0, 0, 0, 1]
                    font_size: 14
                    padding: [10, 11, 10, 10]
                    focus: True
                    multiline: False
                    on_text_validate: login_password.focus = True

            BoxLayout:
                orientation: 'horizontal'
                padding: [0, 5, 0, 5]
                size_hint: (1, 0.5)

                Label:
                    text: 'Password:'
                    size_hint: (0.25, 1)

                TextInput:
                    id: login_password
                    text: ''
                    size_hint: (0.75, 1)
                    hint_text: 'enter your password here'
                    hint_text_color: [0.5, 0.5, 0.5, 1]
                    background_color: [1, 1, 1, 1]
                    cursor_color: [0, 0, 0, 1]
                    foreground_color: [0, 0, 0, 1]
                    font_size: 14
                    padding: [10, 11, 10, 10]
                    focus: True
                    multiline: False
                    password: True
                    on_text_validate: app._login(root.login_username.text, root.login_password.text)

        BoxLayout:
            orientation: 'horizontal'
            height: 50
            size_hint: (1, None)
            spacing: 5

            Button:
                text: 'Register'
                width: 150
                size_hint: (None, 1)
                background_color: [1, 1, 1, .5]
                on_press:
                    app._change_screen("register", app._login_screen)

            Button:
                text: 'Login'
                width: 150
                size_hint: (None, 1)
                background_color: [1, 1, 1, .5]
                on_press:
                    app._login(root.login_username.text, root.login_password.text)

            Button:
                text: 'Cancel'
                width: 150
                size_hint: (None, 1)
                background_color: [1, 1, 1, .5]
                on_press: app.stop()

<RegisterScreen>:
    register_username: register_username.__self__
    register_password: register_password.__self__
    register_snd_password: register_snd_password.__self__
    canvas.before:
        Color:
            rgba: app.colors["back01"]
        Rectangle:
            pos: self.pos
            size: self.size

    BoxLayout:
        id: register_screen
        orientation: 'vertical'
        padding: [20, 20, 20, 20]
        spacing: 10

        BoxLayout:
            orientation: 'vertical'
            padding: [20, 0, 20, 0]

            BoxLayout:
                orientation: 'horizontal'
                padding: [0, 5, 0, 5]
                size_hint: (1, None)
                height: 50

                Label:
                    text: 'Username:'
                    size_hint: (0.4, 1)

                TextInput:
                    id: register_username
                    text: ''
                    size_hint: (0.6, 1)
                    hint_text: 'enter your username here'
                    hint_text_color: [0.5, 0.5, 0.5, 1]
                    background_color: [1, 1, 1, 1]
                    cursor_color: [0, 0, 0, 1]
                    foreground_color: [0, 0, 0, 1]
                    font_size: 14
                    padding: [10, 11, 10, 10]
                    focus: True
                    multiline: False
                    on_text_validate: register_password.focus = True

            BoxLayout:
                orientation: 'horizontal'
                padding: [0, 5, 0, 5]
                size_hint: (1, None)
                height: 50

                Label:
                    text: 'Password:'
                    size_hint: (0.4, 1)

                TextInput:
                    id: register_password
                    text: ''
                    size_hint: (0.6, 1)
                    hint_text: 'enter your password here'
                    hint_text_color: [0.5, 0.5, 0.5, 1]
                    background_color: [1, 1, 1, 1]
                    cursor_color: [0, 0, 0, 1]
                    foreground_color: [0, 0, 0, 1]
                    font_size: 14
                    padding: [10, 11, 10, 10]
                    focus: True
                    multiline: False
                    password: True
                    on_text_validate: register_snd_password.focus = True

            BoxLayout:
                orientation: 'horizontal'
                padding: [0, 5, 0, 5]
                size_hint: (1, None)
                height: 50

                Label:
                    text: 'Confirm Password:'
                    size_hint: (0.4, 1)

                TextInput:
                    id: register_snd_password
                    text: ''
                    size_hint: (0.6, 1)
                    hint_text: 'please verify your password here'
                    hint_text_color: [0.5, 0.5, 0.5, 1]
                    background_color: [1, 1, 1, 1]
                    cursor_color: [0, 0, 0, 1]
                    foreground_color: [0, 0, 0, 1]
                    font_size: 14
                    padding: [10, 11, 10, 10]
                    focus: True
                    multiline: False
                    password: True
                    on_text_validate:
                        app._register(root.register_username.text, root.register_password.text, root.register_snd_password.text)

        BoxLayout:
            orientation: 'horizontal'
            height: 50
            size_hint: (1, None)
            spacing: 5

            Button:
                text: 'Register'
                width: 150
                size_hint: (None, 1)
                background_color: [1, 1, 1, .5]
                on_press:
                    app._register(root.register_username.text, root.register_password.text, root.register_snd_password.text)

            Button:
                text: 'Login'
                width: 150
                size_hint: (None, 1)
                background_color: [1, 1, 1, .5]
                on_press:
                    app._change_screen("login", app._register_screen)

            Button:
                text: 'Cancel'
                width: 150
                size_hint: (None, 1)
                background_color: [1, 1, 1, .5]
                on_press: app.stop()

<NaviDropDown>:
    auto_dismiss: False
    auto_width: False
    width: (window.Window.size[0] - 150) * 0.4
    Button:
        text: 'User'
        size_hint_y: None
        height: 50
        on_release:
            root.dismiss()
            print(self.pos)
    Button:
        text: 'Write'
        size_hint_y: None
        height: 50
        on_release:
            root.dismiss()

    Button:
        text: 'Home'
        size_hint_y: None
        height: 50
        on_release:
            root.dismiss()

<GroupDropDown>:
    auto_dismiss: False
    auto_width: False
    width: window.Window.size[0] - 150
    Button:
        text: 'User'
        size_hint_y: None
        height: 50
        on_release:
            root.dismiss()

    Button:
        text: 'Write'
        size_hint_y: None
        height: 50
        on_release:
            root.dismiss()

    Button:
        text: 'Home'
        size_hint_y: None
        height: 50
        on_release:
            root.dismiss()

<Header>:
    group_drop_down: None
    navi_drop_down1: navi_drop_down1.__self__
    group_drop_down1: group_drop_down1.__self__
    orientation: 'horizontal'
    spacing: 10
    height: 50
    size_hint: (1, None)

    BoxLayout:
        orientation: 'horizontal'
        padding: [0, 9, 0, 9]
        spacing: 10
        width: 100
        size_hint: (None, 1)

        ClickImage:
            source: "https://imagej.net/_images/thumb/a/af/Tux.png/128px-Tux.png"
            width: 32
            size_hint: (None, 1)
            on_press:
                app._get_own_page()

        ClickLabel:
            text: 'username'
            size_hint: (1, 1)
            background: [7/256, 54/256, 66/256, 0]
            on_press:
                app._get_own_page()

    BoxLayout:
        orientation: 'horizontal'
        size_hint: (1, 1)

        Button:
            id: group_drop_down1
            text: 'Group'
            size_hint: (0.6, 1)

        Button:
            id: navi_drop_down1
            text: 'Navigation'
            size_hint: (0.4, 1)

<UserScreen>:
    avatar_url: ""
    groups: []
    posts: []
    rating: 0
    user_id: ""
    username: ""
    post_container: post_container.__self__
    group_drop_down: group_drop_down.__self__

    canvas.before:
        Color:
            rgba: app.colors["back01"]
        Rectangle:
            pos: self.pos
            size: self.size

    BoxLayout:
        orientation: 'horizontal'
        padding: [20, 20, 20, 20]
        spacing: 20

        BoxLayout:
            id: user_info_panel
            orientation: 'vertical'
            size_hint: (0.3, 1)
            spacing: 10
            padding: [20, 60, 20, 60]

            BoxLayout:
                size_hint: (1, 0.6)

            AsyncImage:
                source: "https://imagej.net/_images/thumb/a/af/Tux.png/128px-Tux.png"
                size: (128, 128)
                size_hint: (None, None)

            Label:
                id: user_username
                text: root.username
                font_size: 32
                height: 40
                size_hint: (1, None)
                color: [253/256, 246/256, 227/256, 1]

            Label:
                text: str(root.rating)
                height: 40
                size_hint: (1, None)
                font_size: 24
                color: [0, 1, 0, 1]

            BoxLayout:
                size_hint: (1, 0.4)

            Button:
                text: "Change Password"
                background_color: [1, 1, 1, .5]
                height: 30
                size_hint: (1, None)
                on_press: app._test()

            Button:
                text: "Write Post"
                background_color: [1, 1, 1, .5]
                height: 30
                size_hint: (1, None)
                on_press: app._change_screen("write", app._user_screen)

            Button:
                text: "Log Off"
                background_color: [1, 1, 1, .5]
                height: 30
                size_hint: (1, None)
                on_press: app._logoff()

        BoxLayout:
            orientation: 'vertical'

            Button:
                id: group_drop_down
                text: "Group"
                height: 50
                size_hint: (1, None)

            ScrollView:
                size_hint: (1, 1)
                size: (window.Window.width, window.Window.height)

                GridLayout:
                    id: post_container
                    cols: 1
                    spacing: 100
                    size_hint_y: None
                    padding: [0, 100, 0, 0]





<HomeScreen>:
    post_container: post_container.__self__
    navi_drop_down: header.navi_drop_down1
    group_drop_down: header.group_drop_down1
    canvas.before:
        Color:
            rgba: app.colors["back01"]
        Rectangle:
            pos: self.pos
            size: self.size
    BoxLayout:
        orientation: 'vertical'
        padding: [20, 20, 20, 20]
        spacing: 20

        Header:
            id: header

        BoxLayout:
            ScrollView:
                size_hint: (1, 1)
                size: (window.Window.width, window.Window.height)

                GridLayout:
                    id: post_container
                    cols: 1
                    spacing: 100
                    size_hint_y: None
                    padding: [0, 100, 0, 0]

<WriteGroupEntry@ClickLabel>
    group_name: ""
    group_id: 0
    close_time: "Time"
    text: self.group_name + self.close_time
    font_size: 48
    height: 50
    size_hint: (1, None)
    on_press:
        print("entered")

<WriteScreen>:
    post_container: post_container.__self__
    navi_drop_down: header.navi_drop_down1
    group_drop_down: header.group_drop_down1
    canvas.before:
        Color:
            rgba: app.colors["back01"]
        Rectangle:
            pos: self.pos
            size: self.size
    BoxLayout:
        orientation: 'vertical'
        padding: [20, 20, 20, 20]
        spacing: 20

        Header:
            id: header

        ScrollView:
            size_hint: (1, 1)
            size: (window.Window.width, window.Window.height)

            GridLayout:
                id: post_container
                cols: 1
                spacing: 10
                size_hint_y: None
                padding: [0, 10, 0, 0]

                WriteGroupEntry
                WriteGroupEntry
                WriteGroupEntry
                WriteGroupEntry
                WriteGroupEntry
                WriteGroupEntry
                TextInput:
                    height: 400
                    size_hint: (1, None)
                BoxLayout:
                    orientation: 'horizontal'
                    height: 50
                    size_hint: (1, None)

                    Button:
                        text: "Save"
                        size_x: 150
                        size_hint: (None, 1)

                    Button:
                        text: "Discard"
                        size_x: 150
                        size_hint: (None, 1)

                    BoxLayout:
                        size_hint: (1, 1)

                    Button:
                        text: "Publish"
                        size_x: 150
                        size_hint: (None, 1)

<PostScreen>:
    post_container: post_container.__self__
    navi_drop_down: header.navi_drop_down1
    group_drop_down: header.group_drop_down1
    title: ""
    author: "(author)"
    author_id: ""
    rating: "123"
    post_id: ""
    published: False
    window_id: ""
    canvas.before:
        Color:
            rgba: app.colors["back01"]
        Rectangle:
            pos: self.pos
            size: self.size
    BoxLayout:
        orientation: 'vertical'
        padding: [20, 20, 20, 20]
        spacing: 20

        Header:
            id: header

        ScrollView:
            size_hint: (1, 1)
            size: (window.Window.width, window.Window.height)

            GridLayout:
                id: post_container
                cols: 2
                spacing: 20
                size_hint_y: None
                padding: [20, 0, 20, 0]

                BoxLayout:
                    orientation: 'vertical'
                    spacing: 10
                    width: 80
                    size_hint: (None, 1)
                    padding: [8, 0, 8, 0]
                    ClickImage:
                        source: "https://imagej.net/_images/thumb/a/af/Tux.png/128px-Tux.png"
                        size: (64, 64)
                        size_hint: (None, None)
                        on_press:
                            app._change_screen("user", app._home_screen)
                    ClickLabel:
                        text: root.author
                        height: 20
                        font_size: 16
                        size_hint: [1, None]
                        color: app.colors["cyan"]
                    Label:
                        text: root.rating
                        height: 20
                        font_size: 16
                        size_hint: [1, None]
                        color: app.colors["violet"]
                    BoxLayout

                Label:
                    text: "".join(['x' for i in range(400)])
                    size: self.texture_size
                    text_size: window.Window.size[0] - 250, 250
                    size_hint: (None, None)
                    font_size: 22
                    color: [1, 1, 1, 1]
                    halign: 'left'
                    valign: 'top'
                    markup: True


<GeneralPostEntry>:
    author_id: ""
    author_name: ""
    post_id: ""
    rating: ""
    text: ""
    published: False
    orientation: 'vertical'
    spacing: 5
    padding: [50, 0, 50, 0]
    ClickLabel:
        text: root.text
        size: self.texture_size
        font_size: 22
        text_size: window.Window.size[0] - 150, 100
        halign: "left"
        size_hint: (None, None)
        on_press:
            app._get_single_post(root.post_id)
    ClickLabel:
        text: "[color=2aa198]{author_name}[/color] | [color=6c71c4]{rating}[/color]".format(**{"author_name": root.author_name, "rating": root.rating})
        size: self.texture_size
        font_size: 16
        halign: 'left'
        size_hint: (None, None)
        markup: True

<WindowEntry>:
    count_down: count_down.__self__
    group: ""
    start_time: 0
    duration: 0
    window_id: str
    orientation: 'vertical'
    spacing: 5
    padding: [50, 0, 50, 0]

    ClickLabel:
        text: root.group
        size: self.texture_size
        font_size: 22
        text_size: window.Window.size[0] - 150, 100
        halign: "left"
        size_hint: (None, None)
        on_press:
            app._get_single_post(root.id)
    ClickLabel:
        id: count_down
        text: ""
        size: self.texture_size
        font_size: 16
        halign: 'left'
        size_hint: (None, None)
        markup: True

<GroupEntry>:
    group: ""
    group_id: ""
    text: self.group
    size_hint_y: None
    height: 50
    on_release:
        app._group_down.dismiss()